<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <title>C谩rnicos Condoy - Predicci贸n</title>
</head>

<body>

    <!-- NAVBAR SUPERIOR ESTILO INDEX -->
    <nav class="navbar" style="background-color:#6c0000; padding:12px 25px; display:flex; align-items:center; color:white;">
        <h2 style="margin:0; font-weight:bold;">C谩rnicos Condoy</h2>

        <div style="margin-left:auto; display:flex; gap:25px; align-items:center;">

            <a href="/" class="nav-link" style="color:white; text-decoration:none; font-size:18px;">Inicio</a>
            <a href="/prediccion" class="nav-link" style="color:white; text-decoration:none; font-size:18px;">Predicci贸n</a>
            <a href="/etiquetas" class="nav-link" style="color:white; text-decoration:none; font-size:18px;">Etiquetas</a>
            <a href="/register" class="btn-logout">Crear Usuario</a>
            {% if current_user.is_authenticated %}
                <a href="{{ url_for('logout') }}" class="btn-logout">Cerrar Sesi贸n</a>
            {% else %}
                <a href="{{ url_for('login') }}" class="btn-logout">Iniciar Sesi贸n</a>
            {% endif %}
        </div>
    </nav>

    <!-- CONTENIDO -->
    <main style="margin-top:40px; text-align:center;">

        <h1 style="color:white; margin-bottom:20px;">
            Predicci贸n de Fecha de Vencimiento
        </h1>

        <!-- FORMULARIO -->
        <form action="/prediccion" method="POST">

            <div class="form-row">
            <div class="form-group">
                <label>Fecha de corte:</label>
                <input type="date" name="fecha_corte" required>
            </div>

            <div class="form-group">
                <label>Tipo de carne:</label>
                <select name="tipo_carne" required>
                    <option value="Cabra">Cabra</option>
                </select>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Productos utilizados:</label>
                <select name="productos" required>
                    <option value="Sal">Sal</option>
                    <option value="Vinagre">Vinagre</option>
                    <option value="Condimentos">Condimentos</option>
                </select>
            </div>

            <div class="form-group">
                <label>Tipo de empaque:</label>
                <select name="empaque" required>
                    <option value="Vac铆o">Vac铆o</option>
                    <option value="Atm贸sfera modificada">Atm贸sfera modificada</option>
                </select>
            </div>
        </div>

        <button class="btn-prediccion" type="submit">Generar Etiqueta</button>
    </form>

</div>

        {% if ruta_imagen %}
        <h3 style="color:#fff200;">Etiqueta generada</h3>

        <div id="etiqueta-imprimible" class="Sticker">
            <img src="{{ url_for('static', filename='img/etiqueta_generada.png') }}" 
                 alt="Etiqueta generada" style="width:300px;">
        </div>

        <button onclick="imprimirEtiqueta()"> Imprimir</button>
        {% endif %}

    </main>

    <div id="chatbot-toggle"></div>

<div class="chatbot" id="chatbot-box">
    <div id="chatbot-header">Asistente Virtual</div>
    <div id="chatbot-messages"></div>

    <div id="chatbot-input-area">
        <input type="text" id="chatbot-input" placeholder="Escribe tu mensaje...">
        <button id="chatbot-send">Enviar</button>
    </div>
</div>

<script src="{{ url_for('static', filename='js/chatbot.js') }}"></script>

<script>
const chatbotToggle = document.getElementById("chatbot-toggle");
const chatbotBox = document.getElementById("chatbot-box");

chatbotToggle.addEventListener("click", () => {
    chatbotBox.classList.toggle("active");

    if (chatbotBox.classList.contains("active")) {
        chatbotBox.style.display = "flex";
    } else {
        chatbotBox.style.display = "none";
    }
});
</script>

    <script>
function imprimirEtiqueta() {
    var contenido = document.getElementById("etiqueta-imprimible").innerHTML;

    var ventana = window.open("", "_blank");
    ventana.document.write(`
        <html>
        <head>
            <title>Imprimir Etiqueta</title>
            <style>
                body {
                    font-family: Arial, sans-serif;
                    padding: 20px;
                }
                img {
                    width: 300px;
                }
            </style>
        </head>
        <body>
            ${contenido}
            <script>
                window.onload = function() { window.print(); }
            <\/script>
        </body>
        </html>
    `);
    ventana.document.close();
}
</script>

</body>
</html>
